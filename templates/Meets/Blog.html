{% extends 'Base.html' %}
{% load static %}

{% block title %}
  <title>CUCC | Meets | Blog</title>
{% endblock %}

{% block main-content %}
  <h1>Trip Logs & Photos</h1>
  <table class="w3-table w3-striped w3-card-4">

    {% for p in posts %}

    <tr><td>
    <h2>{{ p.title }} ({{ p.published_date.date }}) {% if user == p.author or user.username == 'webmaster' %}<a class="w3-button w3-right w3-large w3-theme-d4 w3-hover-black" href="{% url 'BlogEdit' pk=p.pk %}">Edit</a>{% endif %}</h2>

    <p>{{ p.text }}</p>
    {% for i in image_list %}
    {% if i.post == p %}
    <div class='w3-center'><img class="w3-image" src="{{ i.images.url }}" alt="{{ p.title }}"></div> <br>
    {% endif %}
    {% endfor %}
    </td></tr>
    {% endfor %}
  </table>


{% if posts.has_other_pages %}
  <div class="pagination w3-bar w3-center w3-padding-32">
    {% if posts.has_previous %}
      <a class="w3-button w3-hover-black" href="?page={{ posts.previous_page_number }}">&laquo;</a>
    {% else %}
      <span class="disabled w3-button">&laquo;</span>
    {% endif %}
    {% for i in posts.paginator.page_range %}
      {% if posts.number == i %}
        <span class="active w3-button w3-black">{{ i }} <span class="sr-only">(current)</span></span>
      {% else %}
        <a class="w3-button w3-hover-black" href="?page={{ i }}">{{ i }}</a>
      {% endif %}
    {% endfor %}
    {% if posts.has_next %}
      <a class="w3-button w3-hover-black" href="?page={{ posts.next_page_number }}">&raquo;</a>
    {% else %}
      <span class="disabled w3-button">&raquo;</span>
    {% endif %}
  </div>
{% endif %}

{% endblock %}

{% block side-content %}
  {% if user.is_authenticated %}
  <h2>Actions</h2>
  <a class="w3-button w3-hover-black w3-theme-d4" href="{% url 'BlogPost' %}">Create new post</a>
  {% endif %}

  <h2>Legacy Logs</h2>
  <p>All pages containing trip logs (among other things) from the old wiki have been preserved (complete with formatting) in the <a href="http://www.srcf.ucam.org/caving/Documents/Legacy/">legacy section of the archive</a>.</p>
{% endblock %}
