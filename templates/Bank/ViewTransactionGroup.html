{% extends 'Base.html' %}
{% load static %}
{% load currency %}

{% block title %}
  <title>CUCC | Bank | View Transaction</title>
{% endblock %}

{% block main-content %}
  <h1>Viewing: {{ transaction_group }}</h1>

  <p><i>Created on {{ transaction_group.created_on.date.isoformat }} at {{ transaction_group.created_on.time.isoformat }} by {{ transaction_group.created_by }}</i></p>
  <p><b>Date:</b> {{ transaction_group.transaction_set.first.entry_set.first.date.date.isoformat }}</p>
  <p><b>Notes:</b> {{ transaction_group.transaction_set.first.entry_set.first.notes }}</p>

  <table class="w3-table w3-striped">
    <tr class="w3-theme-d3">
      <th>Account A</th>
      <th>Credit A</th>
      <th>Account B</th>
      <th>Credit B</th>
      <th>Approved?</th>
      <th>Heritage</th>
    </tr>
    {% for transaction in transaction_group.transaction_set.all %}
      <tr>
        <td colspan="6"><b><a href="{% url 'ViewTransaction' transaction.transaction_key %}">{{ transaction }}</a></b></td>
      </tr>
      {% for entry in transaction.entry_set.all %}
        <tr>
          <td><a href="{% url 'ViewAccount' entry.account_a.account_key %}">{{ entry.account_a }}</a></td>
          <td>{{ entry.credit_a|currency }}</td>
          <td><a href="{% url 'ViewAccount' entry.account_b.account_key %}">{{ entry.account_b }}</a></td>
          <td>{{ entry.credit_b|currency }}</td>
          <td>{{ entry.is_approved }}</td>
          {% if entry.transaction is not None %}
            {% if entry.transaction.transaction_group is not None %}
              <td><a href="{% url 'ViewEntry' entry.entry_key %}">{{ entry.short_id }}</a>, <a href="{% url 'ViewTransaction' entry.transaction.transaction_key %}">{{ entry.transaction }}</a>, <a href="{% url 'ViewTransactionGroup' entry.transaction.transaction_group.group_key %}">{{ entry.transaction.transaction_group }}</a></td>
            {% else %}
              <td><a href="{% url 'ViewEntry' entry.entry_key %}">{{ entry.short_id }}</a>, <a href="{% url 'ViewTransaction' entry.transaction.transaction_key %}">{{ entry.transaction }}</a></td>
            {% endif %}
          {% else %}
          <td><a href="{% url 'ViewEntry' entry.entry_key %}">{{ entry.short_id }}</a></td>
          {% endif %}
        </tr>
      {% endfor %}
    {% endfor %}
  </table>
{% endblock %}

{% block side-content %}
  {% include 'ActionSets/Bank.html' %}
{% endblock %}
